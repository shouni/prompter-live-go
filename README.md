# 🤖 Prompter Live Go - PoC Version

[![Language](https://img.shields.io/badge/Language-Go-blue)](https://golang.org/)
[![Go Version](https://img.shields.io/badge/Go%20Version-1.21%2B-blue)](https://golang.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## 🚀 概要 (About) - リアルタイム対話とAIプロモーションの**可能性を実証するPoCツール**

**🎶 [デモ音声を聴く (MP3形式)](https://github.com/shouni/prompter-live-go/raw/main/assets/audio/prompter_live_demo.mp3)**

**`Prompter Live Go`** は、**Google Gemini の強力な AI**、**Go言語の並行処理能力**、そして **Gemini Live API** の低遅延性能を活用し、YouTube配信におけるリアルタイムな視聴者コメントを**低遅延で処理**し、会話に溶け込む形で応答する**概念実証**（Proof of Concept / PoC）ツールです。

本ツールは、AIが設定されたペルソナに従い、視聴者との会話の流れに自然に溶け込む形で応答することで、**プロモーション導線構築の可能性**を検証することを目的としています。

現時点では**開発初期段階**であり、AIのペルソナ安定性や、配信者の音声入力統合などの**大きな技術的課題**を抱えています。

### 🌸 導入がもたらす**潜在的な**ポジティブな変化

*これらのメリットは、すべての技術的課題が解決された場合に期待されるものです。*

| メリット | 期待される効果 |
| :--- | :--- |
| **リアルタイムなファン対応** | コメントへの即時応答で、ユーザー体験が向上します。**Live API**により応答速度が飛躍的に向上します。 |
| **プロモーション導線の自動構築** | AIが会話の流れを読み取り、**自社サイトへの誘導リンク**やキャンペーン情報を自然にコメントに組み込みます。 |
| **キャラクターの一貫性維持** | AIが厳密なプロンプトに従い、ブランド設定を守って応答します。（**現状、この一貫性に重大な課題があります**） |

-----

## ✅ 評価と今後の展望 (Assessment & Future Outlook)

本ツールは、ライブ配信におけるリアルタイムなAI対話の\*\*概念実証 (PoC)\*\*として、大きな可能性を秘めています。

### 🌟 評価：強みと現行の制約 (Strength & Weakness)

| カテゴリ | 評価 | 詳細 |
| :--- | :--- | :--- |
| **強み** | **リアルタイム性への追求** | **Go言語の並行処理**と**Gemini Live API**を組み合わせることで、従来のシステムに比べ、**飛躍的な低遅延応答**を目指しています。 |
| | **明確な目的意識** | 単なる応答ではなく、「**プロモーション導線の自動構築**」という具体的なビジネス上の価値を目的としています。 |
| | **技術的透明性** | PoCとして抱える**AIペルソナの不安定さ**や**音声入力の未統合**といった**重大な技術的課題**を明確に開示しています。 |
| **制約** | **AIペルソナ設定の不安定さ (Critical Risk)** | `System Instruction`がシステムメッセージとして適切に機能していないため、AIが設定を誤認し、**応答のキャラクター一貫性が損なわれるリスク**が最も高い課題です。 |
| | **文脈認識の限界** | **配信者の発言（音声）を考慮できず、チャットのテキストのみ**に反応するため、会話の文脈を見失うリスクがあります。 |
| | **データ連携の欠如** | 外部APIやデータベース連携（Function Calling/RAG）が未実装なため、プロモーション情報は**静的**に含める必要があり、情報更新の柔軟性に欠けます。 |

-----

## 💡 潜在的な可能性 (Fully Realized Potential)

技術的課題が解決された場合、このツールのコンセプトはライブ配信に以下の**革新的な可能性**をもたらします。

1.  **新しいファンエンゲージメントの創出**

    * AIがチャットの「**賑やかし**」や「**案内役**」を担うことで、配信者はよりコンテンツ作成に集中でき、視聴者は**待たずに応答**を得ることができます。特に**大規模な配信でのコメント取りこぼしを防ぐ**ことができます。

2.  **パーソナライズされたプロモーション**

    * 将来的にRAG（Retrieval-Augmented Generation）やFunction Callingが統合されれば、AIが「この視聴者は以前A商品について質問していた」といった過去の履歴や、現在の\*\*視聴者の感情（ポジティブ/ネガティブ）\*\*を分析し、**最適なタイミングとトーンでプロモーション**を行うことが可能になります。

3.  **24時間365日の対応（VODや非ライブ時も含む）**

    * ライブ配信だけでなく、アーカイブ動画のチャット欄や、その他のQ\&Aセクションにも応用することで、**キャラクターを一貫させた自動カスタマーサポート/プロモーションチャネル**として機能させる可能性もあります。

-----

## 🚀 今後の開発ステップ

実運用可能なツールへ進化させるために、以下のステップが重要となります。

| ステップ | 焦点 | 期待される効果 |
| :--- | :--- | :--- |
| **最優先：ペルソナ安定化** | **Gemini Go SDKの互換性問題解消**と`System Instruction`の**システムメッセージとしての適切な送信**。 | AI応答の品質と**キャラクターの一貫性**を確立し、長期運用に耐えうる基盤を構築します。 |
| **文脈認識の統合** | マイクからの**リアルタイム音声キャプチャロジック**の実装と、**配信者の発言**をAIの入力文脈に組み込む。 | 会話の流れが自然になり、AIが配信者と視聴者の間の適切なタイミングで応答できるようになります。 |
| **高度なプロモーション** | 外部APIやデータベースと連携するための**Function Calling/RAG**の実装。 | **最新の情報**に基づいた、**動的かつパーソナライズされた**プロモーション応答が可能になります。 |
| **安全性の確保** | AI応答の事前フィルタリングや、不適切なコメントを自動で検出・削除する**モデレーション機能**の実装。 | ライブ配信における炎上リスクを低減し、安全な運用を可能にします。 |

-----

## ✨ 技術スタック (Technology Stack)

| 要素 | 技術 / ライブラリ | 役割 |
| :--- | :--- | :--- |
| **言語** | **Go (Golang)** | ツールの開発言語。リアルタイム応答に必要な高い並行処理性能を提供します。 |
| **AI モデル** | **Google Gemini Live API** | 視聴者のコメント分析、キャラクター設定に基づいた応答テキストの**低遅延ストリーミング生成**に使用します。 |
| **YouTube 連携** | **Google OAuth 2.0 / YouTube Data API v3** | チャンネル所有者としての認証（OAuth）、アクティブなライブチャット ID の取得、**ライブチャットのポーリング**、AI応答コメントのポストに使用します。 |
| **リアルタイム処理** | **Go Goroutine & Channel** | コメントの取得、AI処理、APIポストを並行して実行し、低遅延での応答を実現します。 |

-----

## 🛠️ 事前準備と環境設定

### 1\. Go のインストールとビルド

```bash
# リポジトリをクローン
git clone git@github.com:shouni/prompter-live-go.git
cd prompter-live-go

# 依存関係を整理
go mod tidy

# 実行ファイルを bin/ ディレクトリに生成
go build -o bin/prompter\_live
```

### 2\. 環境変数の設定 (必須)

Goアプリケーションは、以下の変数名で認証情報を読み込みます。

#### macOS / Linux (bash/zsh)

```bash
# Gemini API Key（AIとの接続に必要）
export GEMINI\_API\_KEY="YOUR\_GEMINI\_API\_KEY"

# YouTube (GCP) クライアント認証情報
export YT\_CLIENT\_ID="YOUR\_GCP\_CLIENT\_ID"
export YT\_CLIENT\_SECRET="YOUR\_GCP\_CLIENT\_SECRET"
```

#### Windows (PowerShell)

```powershell
# Gemini API Key（AIとの接続に必要）
$env:GEMINI\_API\_KEY="YOUR\_GEMINI\_API\_KEY"

# YouTube (GCP) クライアント認証情報
$env:YT\_CLIENT\_ID="YOUR\_GCP\_CLIENT\_ID"
$env:YT\_CLIENT\_SECRET="YOUR\_GCP\_CLIENT\_SECRET"
```

### 3\. Google Cloud Platform (GCP) の設定 (重要)

本ツールを実行するには、GCPプロジェクトで以下の設定が完了している必要があります。

1.  **YouTube Data API v3 の有効化**:

    * GCPコンソールで、使用するプロジェクトの **「YouTube Data API v3」** を有効化してください。

2.  **OAuth リダイレクト URI の登録**:

    * OAuth 2.0 クライアント ID（ウェブ アプリケーション）の設定で、以下のコールバック URI を**承認済みリダイレクト URI** に追加してください。
        * `http://localhost:8080/callback`
        * `http://localhost:8081/callback` (ポート競合時の予備)

### 4\. プロンプト設定（System Instruction）

AI のキャラクター設定はコマンドライン引数 (`-i` / `--instruction`) で直接渡します。

-----

## 🎯 導入戦略とテストの焦点 (PoCの進め方)

このツールは現在、**AIのペルソナ安定性**と**外部データ連携の欠如**という課題を抱えています。テストでは「コメント応答」に焦点を絞り、以下の戦略でテストを進めることを強く推奨します。

### 1\. ペルソナ安定性の検証に集中

最優先で、AIがキャラクター設定を破綻させずにどれだけ長時間稼働できるかをテストします。

* **テスト環境:** ご自身のチャンネルでの**限定公開**ライブ配信。
* **検証項目:** AIが設定した**System Instruction (`-i` フラグ)のペルソナやルールを維持できている時間**を測定します。
* **推奨:** シンプルなプロンプト、詳細なプロンプト、プロモーション情報を盛り込んだプロンプトなど、複数パターンを比較し、最も安定する設定を探してください。

### 2\. 静的データ運用によるプロモーション戦略

外部 API やデータベース連携は未実装のため、プロモーション情報はプロンプト内に静的に含めます。

* **推奨事項**:
    1.  **最小限のデータ:** 商品名、特徴、購入URLなど、最も重要な情報のみを**簡潔に** `-i` フラグに記述します。
    2.  **トリガーの明記:** 視聴者が特定のキーワードを使った場合のみ、その静的データ（URLなど）を提示するように**プロンプトで厳しく指示**します。

### 3\. 配信者音声入力ロジックの未統合への注意

現在はコメント（テキスト）にのみ反応します。配信者自身の発言はAIに伝わらないため、**配信中はAIの応答とご自身の会話が競合しないよう、手動で注意深く確認**する必要があります。

-----

## ⚠️ 現時点の機能制限

本ツールが「概念実証」段階にある理由は、主に以下の技術的課題によるものです。（詳細は「評価と今後の展望」セクションを参照してください）

1.  **AIペルソナ設定の不安定さ**: `System Instruction`が正しくシステムメッセージとして扱われないため、AIのキャラクター一貫性が損なわれるリスクがあります。
2.  **配信者音声入力ロジックの未統合**: マイクからのリアルタイム音声キャプチャロジックが未実装のため、AIは配信者自身の発言を一切考慮できません。
3.  **オーディオデータはダミー**: 現在は接続維持のためダミーのオーディオデータを送信しているだけです。

**現時点でテスト可能な機能**は、以下のエンドツーエンドのフローです。

* YouTube Live Chatからの**コメント取得**（ポーリング）
* コメントをAIセッションに渡し、**テキスト応答を生成**するプロセス
* AIの応答をYouTube Live Chatに**投稿**するプロセス

-----

## 🚀 使い方 (Usage) と実行例

### 1\. 認証コマンド (`auth`) 🔒

本ツールを最初に実行する際、YouTubeへのコメント投稿権限を得るための**OAuth 2.0 認証**を行います。

```bash
# 標準ポートで認証を開始
./bin/prompter\_live auth

# ポート競合が発生した場合
./bin/prompter\_live auth --oauth-port 8082
```

> **Note:** 認証成功後、プロジェクトルートに `config/token.json` ファイルが生成されます。

### 2\. 自動応答開始コマンド (`run`) 🤖

認証が完了したら、Gemini Live API と YouTube Live Chat への接続を確立し、自動応答を開始します。

```bash
# Live APIに接続し、AIによる自動応答とコメント投稿を開始
./bin/prompter\_live run  \
-c "UCxxxxxxxxxxxxxxxxxxxxxxxxxx"  \
-m "gemini-2.5-flash"  \
-i "あなたは視聴者コメントを代行するAIです。フレンドリーかつ簡潔に返答してください。"
```

#### 固有フラグ

| フラグ | 説明 | デフォルト値 |
| :--- | :--- | :--- |
| `-k`, `--api-key` | Gemini API Key (省略可) | `GEMINI_API_KEY` 環境変数 |
| `-c`, `--youtube-channel-id` | **監視対象の YouTube チャンネル ID (必須)** | **なし** |
| `-m`, `--model` | 使用する Gemini モデル名（Live API対応モデル推奨） | `gemini-2.5-flash` |
| `-i`, `--instruction` | AIの応答ルールやキャラクター設定（System Instruction） | **なし** |
| `-r`, `--modalities` | AIからの応答として期待するデータ形式（現在のパイプラインではTEXTのみを扱います） | `TEXT` |

> **重要**: `run` コマンドは、指定されたチャンネルが**現在アクティブなライブ配信を行っている場合のみ** Live Chat ID を取得し、コメントの投稿が可能です。

### 📜 ライセンス (License)

このプロジェクトは [MIT License](https://opensource.org/licenses/MIT) の下で公開されています。



# 🤖 Prompter Live Go - PoC Version

[![Language](https://img.shields.io/badge/Language-Go-blue)](https://golang.org/)
[![Go Version](https://img.shields.io/badge/Go%20Version-1.21%2B-blue)](https://golang.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## 🚀 概要 (About) - リアルタイム対話とAIプロモーションの**可能性を実証するPoCツール**

**🎶 [デモ音声を聴く (MP3形式)](https://github.com/shouni/prompter-live-go/raw/main/assets/audio/prompter_live_demo.mp3)**

**`Prompter Live Go`** は、**Google Gemini の強力な AI**、**Go言語の並行処理能力**、そして **Gemini Live API** の低遅延性能を活用し、YouTube配信におけるリアルタイムな視聴者コメントを**低遅延で処理**し、会話に溶け込む形で応答する**概念実証**（Proof of Concept / PoC）ツールです。

本ツールは、AIが設定されたペルソナに従い、視聴者との会話の流れに自然に溶け込む形で応答することで、**プロモーション導線構築の可能性**を検証することを目的としています。

現時点では**開発初期段階**であり、AIのペルソナ安定性や、配信者の音声入力統合などの**大きな技術的課題**を抱えています。実運用での利用には、これらの課題の解決が必須です。

### 🌸 導入がもたらす**潜在的な**ポジティブな変化

*これらのメリットは、すべての技術的課題が解決された場合に期待されるものです。現時点では、AIのペルソナが不安定になるリスクがあるため、応答品質は保証されません。*

| メリット | 期待される効果 |
| :--- | :--- |
| **リアルタイムなファン対応** | コメントへの即時応答で、ユーザー体験が向上します。特に**Live API**により応答速度が飛躍的に向上します。 |
| **プロモーション導線の自動構築** | AIが会話の流れを読み取り、**自社サイトへの誘導リンク**やキャンペーン情報を自然にコメントに組み込みます。 |
| **キャラクターの一貫性維持** | AIが厳密なプロンプト（System Instruction）に従い、ブランド設定を守って応答します。（**現状、この一貫性に重大な課題があります**） |

-----

## ✨ 技術スタック (Technology Stack)

| 要素 | 技術 / ライブラリ | 役割 |
| :--- | :--- | :--- |
| **言語** | **Go (Golang)** | ツールの開発言語。リアルタイム応答に必要な高い並行処理性能を提供します。 |
| **AI モデル** | **Google Gemini Live API** | 視聴者のコメント分析、キャラクター設定に基づいた応答テキストの**低遅延ストリーミング生成**に使用します。 |
| **YouTube 連携** | **Google OAuth 2.0 / YouTube Data API v3** | チャンネル所有者としての認証（OAuth）、アクティブなライブチャット ID の取得、**ライブチャットのポーリング**、AI応答コメントのポストに使用します。 |
| **リアルタイム処理** | **Go Goroutine & Channel** | コメントの取得、AI処理、APIポストを並行して実行し、低遅延での応答を実現します。 |

-----

## 🛠️ 事前準備と環境設定

### 1\. Go のインストールとビルド

```

# リポジトリをクローン

git clone git@github.com:shouni/prompter-live-go.git
cd prompter-live-go

# 依存関係を整理

go mod tidy

# 実行ファイルを bin/ ディレクトリに生成

go build -o bin/prompter\_live

```

### 2\. 環境変数の設定 (必須)

Goアプリケーションは、以下の変数名で認証情報を読み込みます。

#### macOS / Linux (bash/zsh)

```

# Gemini API Key（AIとの接続に必要）

export GEMINI\_API\_KEY="YOUR\_GEMINI\_API\_KEY"

# YouTube (GCP) クライアント認証情報

export YT\_CLIENT\_ID="YOUR\_GCP\_CLIENT\_ID"
export YT\_CLIENT\_SECRET="YOUR\_GCP\_CLIENT\_SECRET"

```

#### Windows (PowerShell)

```

# Gemini API Key（AIとの接続に必要）

$env:GEMINI\_API\_KEY="YOUR\_GEMINI\_API\_KEY"

# YouTube (GCP) クライアント認証情報

$env:YT\_CLIENT\_ID="YOUR\_GCP\_CLIENT\_ID"
$env:YT\_CLIENT\_SECRET="YOUR\_GCP\_CLIENT\_SECRET"

```

### 3\. Google Cloud Platform (GCP) の設定 (重要)

本ツールを実行するには、GCPプロジェクトで以下の設定が完了している必要があります。

1.  **YouTube Data API v3 の有効化**:
    * GCPコンソールで、使用するプロジェクトの **「YouTube Data API v3」** を有効化してください。

2.  **OAuth リダイレクト URI の登録**:
    * OAuth 2.0 クライアント ID（ウェブ アプリケーション）の設定で、以下のコールバック URI を**承認済みリダイレクト URI** に追加してください。
        * `http://localhost:8080/callback`
        * `http://localhost:8081/callback` (ポート競合時の予備)

### 4\. プロンプト設定（System Instruction）

AI のキャラクター設定はコマンドライン引数 (`-i` / `--instruction`) で直接渡す方式です。**ただし、次のセクションで述べる重大な技術的制約があるため、その機能には注意が必要です。**

-----

## 🎯 導入戦略とテストの焦点 (PoCの進め方)

このツールは現在、**AIのペルソナ安定性**と**外部データ連携の欠如**という課題を抱えています。そのため、導入フェーズでは「コメント応答」に焦点を絞り、以下の戦略でテストを進めることを強く推奨します。

### 1\. ペルソナ安定性の検証に集中

最優先で、AIがキャラクター設定を破綻させずにどれだけ長時間稼働できるかをテストします。

* **テスト環境:** ご自身のチャンネルでの**限定公開**ライブ配信。
* **検証項目:** 様々な長さやトーンのコメントを投稿し、AIが設定した**System Instruction (`-i` フラグ)**のペルソナやルール（応答トーン、禁止事項など）を**維持できている時間**を測定します。
* **実験の推奨:** シンプルなプロンプト、詳細なプロンプト、プロモーション情報を盛り込んだプロンプトなど、複数パターンを比較し、最も安定する設定を探してください。

### 2\. 静的データ運用によるプロモーション戦略

外部 API やデータベース連携（Function Calling/RAG）は未実装のため、プロモーション情報はプロンプト内に静的に含めます。

* **推奨事項**:
    1.  **最小限のデータ:** 商品名、特徴、購入URLなど、最も重要な情報のみを**簡潔に** `-i` フラグに記述します。
    2.  **トリガーの明記:** 視聴者が「サイト」「価格」「どこで買う」といった特定のキーワードを使った場合のみ、その静的データ（URLなど）を提示するように**プロンプトで厳しく指示**します。

### 3\. 配信者音声入力ロジックの未統合

現在はコメント（テキスト）にのみ反応します。配信者自身の発言はAIに伝わらないため、**配信中はAIの応答とご自身の会話が競合しないよう、手動で注意深く確認**する必要があります。

-----

## ⚠️ 現時点の機能制限とPoCとしての注意点

本ツールが「概念実証」段階にある理由は、主に以下の2つの技術的課題によるものです。

### 1\. AIペルソナ設定の不安定さ (Critical Risk)

| 課題 | 詳細 | 影響 |
| :--- | :--- | :--- |
| **システム指示の誤認識** | Go SDKの互換性問題により、AIのペルソナを設定する`System Instruction`は、セッション開始時に**最初のユーザーメッセージとして**送信されています。 | AIが設定を**ユーザーからの発言**と誤認し、**応答のペルソナやキャラクターの一貫性が損なわれるリスク**があります。長期運用では、AIが設定を無視したり、破綻したりする可能性が高まります。 |

### 2\. 配信者音声入力ロジックの未統合

| 課題 | 詳細 | 影響 |
| :--- | :--- | :--- |
| **オーディオデータはダミー** | 現在のパイプラインは、**ダミーのオーディオデータ**を継続的にAPIに送信し、接続を維持しているだけです。マイクからのリアルタイム音声キャプチャロジックは実装されていません。 | AIは**配信者自身の発言（音声）**を一切考慮できず、YouTubeチャット（テキスト）のみに基づいて応答します。これにより、**会話の文脈を完全に見失う**可能性があります。 |
| **今後の対応** | マイク入力を統合するには、OS依存の外部オーディオライブラリ（例: PortAudioなど）の導入と、複雑な音声処理ロジックの実装が不可欠です。 | |

### 現時点でテスト可能な機能

以下のエンドツーエンドのフローは、制限付きではありますがテスト可能です。

* YouTube Live Chatからの**コメント取得**（ポーリング）
* コメントをAIセッションに渡し、**テキスト応答を生成**するプロセス
* AIの応答をYouTube Live Chatに**投稿**するプロセス

-----

## 🚀 使い方 (Usage) と実行例

### 1\. 認証コマンド (`auth`) 🔒

本ツールを最初に実行する際、YouTubeへのコメント投稿権限を得るための**OAuth 2.0 認証**を行います。

```

# 標準ポートで認証を開始

./bin/prompter\_live auth

# ポート競合が発生した場合

./bin/prompter\_live auth --oauth-port 8082

```

> **Note:** 認証成功後、プロジェクトルートに `config/token.json` ファイルが生成されます。

### 2\. 自動応答開始コマンド (`run`) 🤖

認証が完了したら、Gemini Live API と YouTube Live Chat への接続を確立し、自動応答を開始します。

```

# Live APIに接続し、AIによる自動応答とコメント投稿を開始

./bin/prompter\_live run  
\-c "UCxxxxxxxxxxxxxxxxxxxxxxxxxx"  
\-m "gemini-2.5-flash"  
\-i "あなたは視聴者コメントを代行するAIです。フレンドリーかつ簡潔に返答してください。"

```

#### 固有フラグ

| フラグ | 説明 | デフォルト値 |
| :--- | :--- | :--- |
| `-k`, `--api-key` | Gemini API Key (省略可) | `GEMINI_API_KEY` 環境変数 |
| `-c`, `--youtube-channel-id` | **監視対象の YouTube チャンネル ID (必須)** | **なし** |
| `-m`, `--model` | 使用する Gemini モデル名（Live API対応モデル推奨） | `gemini-2.5-flash` |
| `-i`, `--instruction` | AIの応答ルールやキャラクター設定（System Instruction） | **なし** |
| `-r`, `--modalities` | AIからの応答として期待するデータ形式（現在のパイプラインではTEXTのみを扱います） | `TEXT` |

> **重要**: `run` コマンドは、指定されたチャンネルが**現在アクティブなライブ配信を行っている場合のみ** Live Chat ID を取得し、コメントの投稿が可能です。

### 📜 ライセンス (License)

このプロジェクトは [MIT License](https://opensource.org/licenses/MIT) の下で公開されています。


